
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE10;IE=EmulateIE9">
<meta name="renderer" content="webkit"/>
<meta http-equiv="X-UA-Compatible" content="edge"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="shortcut icon" href="/style/images/index/favicon.png"/>
<link rel="stylesheet" type="text/css" href="../js/lib/easyui1.4.4/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="../js/lib/easyui1.4.4/themes/icon.css">
<link rel="stylesheet" type="text/css" href="../style/wb.css">
<link rel="stylesheet" type="text/css" href="../style/main.css"/>
<script type="text/javascript" src="../js/loader.js"></script>
<script type="text/javascript" charset="utf-8" src="../ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="../ueditor/ueditor.all.min.js"></script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="../ueditor/lang/zh-cn/zh-cn.js"></script>
<!--<script type="text/javascript" charset="utf-8" src="../ueditor/third-party/jquery-1.10.2.min.js"></script>-->
<script src="../js/lib/store.js" charset="utf-8"></script>
<script type="text/javascript">
    var data;
    loader.load('common', function () {
        data = parent.window.datas;
        $("#mid").val(data);
        parent.window.datas = null;
        $.ajax({
            type: "get",
            url: store.get("context") + "/doc/get/" + data,
            dataType: "json",
            cache: false,
            success: function (result) {
                if (result) {
                    $.each(result.contentList, function (index, obj) {
                        $("#content").append(obj.content);
                    });
                }
            }
        });
        $('#form').form({
            url: store.get("context") + "/doc/reviewed",
            onSubmit: function () {
                progressLoad();
                var isValid = $(this).form('validate');
                if (!isValid) {
                    progressClose();
                }
                return isValid;
            },
            success: function (result) {
                progressClose();
                result = $.parseJSON(result);
                if (result.success) {
                    parent.window.refresh();
                    parent.window.closeTab();
                    $.messager.alert('提示', result.msg, 'info');
                    delete parent.window.refresh;
                } else {
                    $.messager.alert('错误', result.msg, 'error');
                }
            }
        });
    });

    function submitFrom() {
        var status = $("[name = 'status']:checked").val();
        if(status == "3"){
            var opinion = $("#opinion").val();
            if(!opinion){
                alert("请填写审核意见");
                return;
            }
        }
        $("#form").submit();
    }
</script>
<body class="easyui-layout" data-options="fit:true,border:false" style="text-align: center;">
<div data-options="region:'center',border:false" title="">
    <div id="content">
    </div>
    <form id="form" method="post">
        <input id="mid" name="mid" type="hidden"/>
        <table class="grid">
            <tr>
                <td>审核意见</td>
                <td colspan="3" style="padding:10px">
                    <input name="opinion" id="opinion" class="easyui-textbox"
                           data-options="multiline:true,width:500,height:100" >
                </td>
            </tr>
            <tr>
                <td>审核状态</td>
                <td style="text-align:left">
                        <span class="radioSpan">
                            <input type="radio" name="status" checked value="2">通过</input>
                            <input type="radio" name="status" value="3">不通过</input>
                        </span>
                </td>
                <td>是否推送</td>
                <td style="text-align:left">
                        <span class="radioSpan">
                            <input type="radio" name="isMessage" checked value="true">推送</input>
                            <input type="radio" name="isMessage" value="false">不推送</input>
                        </span>
                </td>
            </tr>
        </table>
        <a href="#" id="btn" class="easyui-linkbutton" style="margin-left: 40%;margin-top: 10px;"
           data-options="iconCls:'icon-ok'" onclick="submitFrom()">提交审核</a>
    </form>
</div>
</body>